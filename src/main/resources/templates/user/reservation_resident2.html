<!doctype html>
<html layout:decorate="~{user/layout_user}">

<meta charset="utf-8">

<div layout:fragment="content">
  
    <link rel="shortcut icon" href="/assets/images/favicon.png">
    <link rel="stylesheet" href="/assets/css/animate.min.css">
    <link rel="stylesheet" href="/assets/css/style.css">
    <link rel="stylesheet" type="text/css" href="/assets/css/responsive.css">
    <link rel="stylesheet" type="text/css" href="/assets/css/color.css">
    
    <link rel="stylesheet" type="text/css" href="/assets/css/reservation_user.css">
    
    <link rel="stylesheet" href="//code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">



        <div class="popup" id="sign-popup">
            <h3>Sign In to your Account</h3>
            <div class="popup-form">
                <form>
                    <div class="form-field">
                        <input type="text" name="username" placeholder="Username">
                    </div>
                    <div class="form-field">
                        <input type="text" name="password" placeholder="Password">
                    </div>
                    <div class="form-cp">
                        <div class="form-field">
                            <div class="input-field">
                                <input type="checkbox" name="ccc" id="cc1">
                                <label for="cc1">
                                    <span></span>
                                    <small>Remember me</small>
                                </label>
                            </div>
                        </div>
                        <a href="#" title="">Forgot Password?</a>
                    </div><!--form-cp end-->
                    <button type="submit" class="btn2">Sign In</button>
                </form>
                <a href="#" title="" class="fb-btn"> <i class="fa fa-facebook"></i>Sign In With Facebook</a>
            </div>
        </div><!--popup end-->

        <div class="popup" id="register-popup">
            <h3>Register</h3>
            <div class="popup-form">
                <form>
                    <div class="form-field">
                        <input type="text" name="username" placeholder="Username">
                    </div>
                    <div class="form-field">
                        <input type="text" name="email" placeholder="Email">
                    </div>
                    <div class="form-field">
                        <input type="text" name="password" placeholder="Password">
                    </div>
                    <div class="form-cp">
                        <div class="form-field">
                            <div class="input-field">
                                <input type="checkbox" name="ccc" id="cc2">
                                <label for="cc2">
                                    <span></span>
                                    <small>I agree with terms</small>
                                </label>
                            </div>
                        </div>
                        <a href="#" title="" class="signin-op">Have an account?</a>
                    </div><!--form-cp end-->
                    <button type="submit" class="btn2">Register</button>
                </form>
            </div>
        </div><!--popup end-->
        
        

        <section class="pager-sec bfr">
            <div class="container">
                <div class="pager-sec-details">
                    <h3>거주자 예약</h3>
                    <ul>
                        <li><a href="#" title="">Home</a></li>
                        <li><span>Agent Profile</span></li>
                    </ul>
                </div><!--pager-sec-details end-->
            </div>
        </section>

		
        <section class="page-main-content section-padding">
            <div class="container">
                <div class="agent-profile-sec">
                    <div class="row" style="flex-direction: column;">
                        <div class="col-xl-8 col-lg-9 col-md-12 pl-0 pr-0">
                            <div class="agent-profile5">                                                             
                            </div><!--agent-profile end-->
                        </div>
                        
                        <form th:object="${residenceReservDTO}" th:action="@{/newzips/reservation_resident1}" name="makeReservation" method="post" onsubmit="return makeReservation(event);">
                        <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}"/>
					     <input type="hidden" th:field="*{availableDate}"/>
					    <input type="hidden" th:field="*{availableTime}"/>
						                        
                        <div class="col-xl-4 col-lg-3 col-md-12 pr-0" style="padding-left: 0; padding-right: 0;">
                            <div class="contact-agent" style="width: 130%; padding-left:0; margin-left: -15%;">
                            
                            <div style="margin-top: 40px"></div>
                                <h3 style="margin-bottom: 15px; text-align: center;"></h3>
                                
                                <div style="display: flex; align-items: center;">
                                <div id="datepicker" style="font-size: 2.3em;"></div>
                               <div class="container" style="font-size: 40px; max-width:250px; margin-right: 0; margin-left: 100px;">
								   <div class="time-slot">
								    <span>9:00</span>
								    <label class="toggle-switch">
								      <input type="checkbox" value="9:00">
								      <span class="toggle-slider"></span>
								    </label>
								  </div>
								  <div class="time-slot">
								    <span>10:00</span>
								    <label class="toggle-switch">
								      <input type="checkbox" value="10:00">
								      <span class="toggle-slider"></span>
								    </label>
								  </div>
								  <div class="time-slot">
								    <span>11:00</span>
								    <label class="toggle-switch">
								      <input type="checkbox" value="11:00">
								      <span class="toggle-slider"></span>
								    </label>
								  </div>
								  <div class="time-slot">
								    <span>12:00</span>
								    <label class="toggle-switch">
								      <input type="checkbox" value="12:00">
								      <span class="toggle-slider"></span>
								    </label>
								  </div>
								  <div class="time-slot">
								    <span>13:00</span>
								    <label class="toggle-switch">
								      <input type="checkbox" value="13:00">
								      <span class="toggle-slider"></span>
								    </label>
							    </div>
							    <div class="time-slot">
								    <span>14:00</span>
								    <label class="toggle-switch">
								      <input type="checkbox" value="14:00">
								      <span class="toggle-slider"></span>
								    </label>
							    </div>
							    <div class="time-slot">
								    <span>15:00</span>
								    <label class="toggle-switch">
								      <input type="checkbox" value="15:00">
								      <span class="toggle-slider"></span>
								    </label>
							    </div>
							    <div class="time-slot">
								    <span>16:00</span>
								    <label class="toggle-switch">
								      <input type="checkbox" value="16:00">
								      <span class="toggle-slider"></span>
								    </label>
							    </div>
							    <div class="time-slot">
								    <span>17:00</span>
								    <label class="toggle-switch">
								      <input type="checkbox" value="17:00">
								      <span class="toggle-slider"></span>
								    </label>
							    </div>
							    <div class="time-slot">
								    <span>18:00</span>
								    <label class="toggle-switch">
								      <input type="checkbox" value="18:00">
								      <span class="toggle-slider"></span>
								    </label>
							    </div>
						    </div>
						    </div>

                                <div style="margin-bottom: 5%;"></div>
                               
                                 <div style="width: 55%;">
								    <div class="form-field5">
								        <div style="margin-bottom: 30px;"></div>
								        <button type="submit" class="btn2" style="width: 40%; margin-left: 100%;" id="submit-btn">저장</button>
								    </div> 
								</div>
                            </div><!--contact-agent end-->
                        </div>
                       </form>
                    </div>
                </div><!--agent-profile-sec end-->
            </div>
        </section><!--page-main-content end-->
        
        
        



    <script src="/assets/js/jquery-3.3.1.min.js"></script>
    <script src="/assets/js/modernizr-3.6.0.min.js"></script>
    <script src="/assets/js/bootstrap.min.js"></script>
    
    <script src="//code.jquery.com/jquery-1.12.4.js"></script>
	<script src="//code.jquery.com/ui/1.12.1/jquery-ui.js"></script>

    <!-- Maps -->
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCjCGmQ0Uq4exrzdcL6rvxywDDOvfAu6eE"></script>
    <script src="/assets/js/map-cluster/infobox.min.js"></script>
    <script src="/assets/js/map-cluster/markerclusterer.js"></script>
    <script src="/assets/js/map-cluster/maps.js"></script>

<<<<<<< HEAD:src/main/resources/templates/user/reservation_resident2.html
<script>

$(function() {
    // 달력의 기본값을 오늘 날짜로 설정
    $("#datepicker").datepicker({
      dateFormat: "yy-mm-dd",
      defaultDate: new Date(),
      minDate: 0,
=======
<script type="text/javascript">
    
    const timeSlots = document.querySelectorAll('.time-slot');

    timeSlots.forEach((timeSlot) => {
      const toggleSwitch = timeSlot.querySelector('.toggle-switch input');
      const toggleLabel = timeSlot.querySelector('.toggle-label');
      
      toggleSwitch.addEventListener('change', () => {
        if (toggleLabel !== null) {
          toggleLabel.textContent = toggleSwitch.checked ? 'on' : 'off';
        }
        const time = toggleSwitch.closest('.time-slot').querySelector('span').textContent;
        if (toggleSwitch.checked) {
          selectedTimes.push(time);
        } else {
          const index = selectedTimes.indexOf(time);
          if (index !== -1) {
            selectedTimes.splice(index, 1);
          }
        }
      });
    });
    
    $(function() {
      $("#datepicker").datepicker({
    	  minDate:0,
        onSelect: function(dateText) {
          const dateObject = $(this).datepicker('getDate');
          const year = dateObject.getFullYear();
          const month = ("0" + (dateObject.getMonth() + 1)).slice(-2);
          const day = ("0" + dateObject.getDate()).slice(-2);
          selectedDate = year + '-' + month + '-' + day;
        }
      });
>>>>>>> a498c2006b1e1f57b31fbb18d1ed25b7dc1d7012:src/main/resources/templates/user/reservation_resident1.html
    });

    const availableDateElement = $("#datepicker");
    const timeSlots = $(".time-slot");
    let availableDate = '';
    const availableTime = [];

    availableDateElement.on("change", () => {
        const dateObject = availableDateElement.datepicker("getDate");
        const year = dateObject.getFullYear();
        const month = ("0" + (dateObject.getMonth() + 1)).slice(-2);
        const day = ("0" + dateObject.getDate()).slice(-2);
        availableDate = year + '-' + month + '-' + day;
    });

    timeSlots.each(function(index, timeSlot) {
        const toggleSwitch = $(timeSlot).find('.toggle-switch input');
        const toggleLabel = $(timeSlot).find('.toggle-label');

        toggleSwitch.on("change", () => {
            if (toggleLabel !== null) {
              toggleLabel.text(toggleSwitch.prop("checked") ? 'on' : 'off');
            }
            const time = toggleSwitch.closest('.time-slot').find('span').text();
            if (toggleSwitch.prop("checked")) {
              availableTime.push(time);
            } else {
              const index = availableTime.indexOf(time);
              if (index !== -1) {
                availableTime.splice(index, 1);
              }
            }
        });
    });

    function makeReservation(event) {
    	
        if (!availableDate) {
            alert('날짜를 선택해주세요.');
            return;
        }

        if (availableTime.length === 0) {
            alert('시간을 선택해주세요.');
            return;
        }

        console.log('날짜: ',availableDate);
        console.log('시간: ',availableTime);
        
        const confirmMsg = `날짜: ${availableDate}\n시간: ${availableTime.join(', ')}\n\n맞으면 확인눌러`;
        const confirmed = confirm(confirmMsg);
        if (!confirmed) {
          return;
        }

        const formData = new FormData();
        formData.append('availableDate', availableDate);

        // 시간 토글들의 name은 모두 "time[]"으로 설정
        const timeInputs = $('.time-slot input[type="checkbox"]');
        timeInputs.each(function() {
        	  $(this).attr('name', 'time[]');
        	  $(this).prop('checked', false); // 디폴트로 off 설정
        	});

        availableTime.forEach((time) => {
            formData.append('time[]', time); // 여러개 선택할 수 있으므로 배열 형태로 전송
        });

        const form = $('<form>').attr({
            'method': 'post',
            'action': '/newzips/reservation_resident1'
        }).append(formData);

        $('body').append(form);

        form.submit();
    }
    
    $('#submit-btn').on('click', makeReservation);
});


</script>

</div><!--layout fragment end-->



</html>